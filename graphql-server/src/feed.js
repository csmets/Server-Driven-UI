const { signal } = require('./signal');
const mockResponseData = require('./mock/mockRemoteDataResponse.json');

const favouriteAction = (feedId, signal) => {
  return {
    feedId,
    signal
  };
};

const feedImage = (src, alt) => {
  return {
    src,
    alt
  };
};

const feedCaption = (text) => {
  return {
    text
  }
};

const feedFavourite = (feedId) => {
  const ok = "data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIC0yOCA1MTIuMDAwMDEgNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Im01MTIgMTUzLjg2NzE4OGMwIDQzLjI5Mjk2OC0xNi4xMzI4MTIgODIuOTQxNDA2LTUwLjc3MzQzOCAxMjQuNzM0Mzc0LTMwLjk5NjA5MyAzNy4zOTg0MzgtNzUuNTMxMjUgNzUuMzU1NDY5LTEyNy4xMTMyODEgMTE5LjMwODU5NC0xNy42MjUgMTUuMDE1NjI1LTM3LjU5NzY1NiAzMi4wMzkwNjMtNTguMzIwMzEyIDUwLjE3MTg3NS01LjQyOTY4OCA0Ljc1LTEyLjM4NjcxOSA3LjM4NjcxOS0xOS42MTMyODEgNy40Mjk2ODhoLS4xNzk2ODhjLTcuMjg5MDYyIDAtMTQuMzE2NDA2LTIuNjQwNjI1LTE5Ljc5Mjk2OS03LjQzNzUtMjAuNjgzNTkzLTE4LjA4NTkzOC00MC42MjUtMzUuMDg5ODQ0LTU4LjIxODc1LTUwLjA4NTkzOGwtLjA4OTg0My0uMDY2NDA2Yy01MS41NzQyMTktNDMuOTU3MDMxLTk2LjEyODkwNy04MS45MjE4NzUtMTI3LjExNzE4OC0xMTkuMzIwMzEzLTM0LjY0ODQzOC00MS43OTI5NjgtNTAuNzgxMjUtODEuNDQxNDA2LTUwLjc4MTI1LTEyNC43MzQzNzQgMC00Mi4wNjY0MDcgMTQuNDI1NzgxLTgwLjg4MjgxMyA0MC42MTcxODgtMTA5LjI5Mjk2OSAyNi41MDc4MTItMjguNzUgNjIuODc1LTQ0LjU3NDIxOSAxMDIuNDE0MDYyLTQ0LjU3NDIxOSAyOS41NTg1OTQgMCA1Ni42MTcxODggOS4zMzU5MzggODAuNDQ5MjE5IDI3Ljc2MTcxOSAxMi4wMjczNDMgOS4zMDQ2ODcgMjIuOTIxODc1IDIwLjY3OTY4NyAzMi41MTk1MzEgMzMuOTY0ODQzbC4xNzk2ODgtLjIzODI4MWM5LjU1ODU5My0xMy4xODM1OTMgMjAuMzk0NTMxLTI0LjQ4MDQ2OSAzMi4zNDc2NTYtMzMuNzI2NTYyIDIzLjgyNDIxOC0xOC40MjU3ODEgNTAuODk0NTMxLTI3Ljc2MTcxOSA4MC40NDE0MDYtMjcuNzYxNzE5IDM5LjU0Njg3NSAwIDc1LjkxNDA2MiAxNS44MjQyMTkgMTAyLjQxNDA2MiA0NC41NzQyMTkgMjYuMTkxNDA3IDI4LjQxMDE1NiA0MC42MTcxODggNjcuMjE0ODQzIDQwLjYxNzE4OCAxMDkuMjkyOTY5em0wIDAiIGZpbGw9IiNmZjVlOTUiLz48cGF0aCBkPSJtNTEyIDE1My44NjcxODhjMCA0My4yOTI5NjgtMTYuMTMyODEyIDgyLjk0MTQwNi01MC43NzM0MzggMTI0LjczNDM3NC0zMC45OTYwOTMgMzcuMzk4NDM4LTc1LjUzMTI1IDc1LjM1NTQ2OS0xMjcuMTEzMjgxIDExOS4zMDg1OTQtMTcuNjI1IDE1LjAxNTYyNS0zNy41OTc2NTYgMzIuMDM5MDYzLTU4LjMyMDMxMiA1MC4xNzE4NzUtNS40Mjk2ODggNC43NS0xMi4zODY3MTkgNy4zODY3MTktMTkuNjEzMjgxIDcuNDI5Njg4di0zOTQuMDIzNDM4YzkuNTU4NTkzLTEzLjE4MzU5MyAyMC4zOTQ1MzEtMjQuNDgwNDY5IDMyLjM0NzY1Ni0zMy43MjY1NjIgMjMuODI0MjE4LTE4LjQyNTc4MSA1MC44OTQ1MzEtMjcuNzYxNzE5IDgwLjQ0MTQwNi0yNy43NjE3MTkgMzkuNTQ2ODc1IDAgNzUuOTE0MDYyIDE1LjgyNDIxOSAxMDIuNDE0MDYyIDQ0LjU3NDIxOSAyNi4xOTE0MDcgMjguNDEwMTU2IDQwLjYxNzE4OCA2Ny4yMTQ4NDMgNDAuNjE3MTg4IDEwOS4yOTI5Njl6bTAgMCIgZmlsbD0iI2ZmMzk4MCIvPjwvc3ZnPg";
  const error = "Failed! Something went wrong";
  return {
    align: 'LEFT',
    icon: 'data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIC0yOCA1MTIuMDAxIDUxMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtMjU2IDQ1NS41MTU2MjVjLTcuMjg5MDYyIDAtMTQuMzE2NDA2LTIuNjQwNjI1LTE5Ljc5Mjk2OS03LjQzNzUtMjAuNjgzNTkzLTE4LjA4NTkzNy00MC42MjUtMzUuMDgyMDMxLTU4LjIxODc1LTUwLjA3NDIxOWwtLjA4OTg0My0uMDc4MTI1Yy01MS41ODIwMzItNDMuOTU3MDMxLTk2LjEyNS04MS45MTc5NjktMTI3LjExNzE4OC0xMTkuMzEyNS0zNC42NDQ1MzEtNDEuODA0Njg3LTUwLjc4MTI1LTgxLjQ0MTQwNi01MC43ODEyNS0xMjQuNzQyMTg3IDAtNDIuMDcwMzEzIDE0LjQyNTc4MS04MC44ODI4MTMgNDAuNjE3MTg4LTEwOS4yOTI5NjkgMjYuNTAzOTA2LTI4Ljc0NjA5NCA2Mi44NzEwOTMtNDQuNTc4MTI1IDEwMi40MTQwNjItNDQuNTc4MTI1IDI5LjU1NDY4OCAwIDU2LjYyMTA5NCA5LjM0Mzc1IDgwLjQ0NTMxMiAyNy43Njk1MzEgMTIuMDIzNDM4IDkuMzAwNzgxIDIyLjkyMTg3NiAyMC42ODM1OTQgMzIuNTIzNDM4IDMzLjk2MDkzOCA5LjYwNTQ2OS0xMy4yNzczNDQgMjAuNS0yNC42NjAxNTcgMzIuNTI3MzQ0LTMzLjk2MDkzOCAyMy44MjQyMTgtMTguNDI1NzgxIDUwLjg5MDYyNS0yNy43Njk1MzEgODAuNDQ1MzEyLTI3Ljc2OTUzMSAzOS41MzkwNjMgMCA3NS45MTAxNTYgMTUuODMyMDMxIDEwMi40MTQwNjMgNDQuNTc4MTI1IDI2LjE5MTQwNiAyOC40MTAxNTYgNDAuNjEzMjgxIDY3LjIyMjY1NiA0MC42MTMyODEgMTA5LjI5Mjk2OSAwIDQzLjMwMDc4MS0xNi4xMzI4MTIgODIuOTM3NS01MC43NzczNDQgMTI0LjczODI4MS0zMC45OTIxODcgMzcuMzk4NDM3LTc1LjUzMTI1IDc1LjM1NTQ2OS0xMjcuMTA1NDY4IDExOS4zMDg1OTQtMTcuNjI1IDE1LjAxNTYyNS0zNy41OTc2NTcgMzIuMDM5MDYyLTU4LjMyODEyNiA1MC4xNjc5NjktNS40NzI2NTYgNC43ODkwNjItMTIuNTAzOTA2IDcuNDI5Njg3LTE5Ljc4OTA2MiA3LjQyOTY4N3ptLTExMi45Njg3NS00MjUuNTIzNDM3Yy0zMS4wNjY0MDYgMC01OS42MDU0NjkgMTIuMzk4NDM3LTgwLjM2NzE4OCAzNC45MTQwNjItMjEuMDcwMzEyIDIyLjg1NTQ2OS0zMi42NzU3ODEgNTQuNDQ5MjE5LTMyLjY3NTc4MSA4OC45NjQ4NDQgMCAzNi40MTc5NjggMTMuNTM1MTU3IDY4Ljk4ODI4MSA0My44ODI4MTMgMTA1LjYwNTQ2OCAyOS4zMzIwMzEgMzUuMzk0NTMyIDcyLjk2MDkzNyA3Mi41NzQyMTkgMTIzLjQ3NjU2MiAxMTUuNjI1bC4wOTM3NS4wNzgxMjZjMTcuNjYwMTU2IDE1LjA1MDc4MSAzNy42Nzk2ODggMzIuMTEzMjgxIDU4LjUxNTYyNSA1MC4zMzIwMzEgMjAuOTYwOTM4LTE4LjI1MzkwNyA0MS4wMTE3MTktMzUuMzQzNzUgNTguNzA3MDMxLTUwLjQxNzk2OSA1MC41MTE3MTktNDMuMDUwNzgxIDk0LjEzNjcxOS04MC4yMjI2NTYgMTIzLjQ2ODc1LTExNS42MTcxODggMzAuMzQzNzUtMzYuNjE3MTg3IDQzLjg3ODkwNy02OS4xODc1IDQzLjg3ODkwNy0xMDUuNjA1NDY4IDAtMzQuNTE1NjI1LTExLjYwNTQ2OS02Ni4xMDkzNzUtMzIuNjc1NzgxLTg4Ljk2NDg0NC0yMC43NTc4MTMtMjIuNTE1NjI1LTQ5LjMwMDc4Mi0zNC45MTQwNjItODAuMzYzMjgyLTM0LjkxNDA2Mi0yMi43NTc4MTIgMC00My42NTIzNDQgNy4yMzQzNzQtNjIuMTAxNTYyIDIxLjUtMTYuNDQxNDA2IDEyLjcxODc1LTI3Ljg5NDUzMiAyOC43OTY4NzQtMzQuNjA5Mzc1IDQwLjA0Njg3NC0zLjQ1MzEyNSA1Ljc4NTE1Ny05LjUzMTI1IDkuMjM4MjgyLTE2LjI2MTcxOSA5LjIzODI4MnMtMTIuODA4NTk0LTMuNDUzMTI1LTE2LjI2MTcxOS05LjIzODI4MmMtNi43MTA5MzctMTEuMjUtMTguMTY0MDYyLTI3LjMyODEyNC0zNC42MDkzNzUtNDAuMDQ2ODc0LTE4LjQ0OTIxOC0xNC4yNjU2MjYtMzkuMzQzNzUtMjEuNS02Mi4wOTc2NTYtMjEuNXptMCAwIi8+PC9zdmc+',
    action: favouriteAction(feedId, signal(`signal-${feedId}`, ok, error))
  }
};

const feedFavouriteCount = (count, feedId) => {
  return {
    align: 'RIGHT',
    count,
    signal: signal(`signal-${feedId}`, 22, count)
  };
};

const feedColumn = (count, feedId) => {
  return {
    columns: [
      feedFavourite(feedId),
      feedFavouriteCount(count, feedId)
    ]
  }
}

const feedItemFactory = (id, caption, image, alt, count) => {
  return {
    items: [
      feedImage(image, alt),
      feedColumn(count, id),
      feedCaption(caption)
    ]
  }
};

const fetchFeed = () => {
  const data = mockResponseData

  const feedList = data.map(({id, caption, image, alt, count}) => feedItemFactory(id, caption, image, alt, count));

  return feedList
};

module.exports = {
  fetchFeed
};